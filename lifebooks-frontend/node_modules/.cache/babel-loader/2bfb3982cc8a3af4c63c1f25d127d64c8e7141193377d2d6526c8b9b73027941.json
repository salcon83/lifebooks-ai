{"ast":null,"code":"import _objectSpread from\"/home/ubuntu/lifebooks-ai/lifebooks-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const StoryCreator=()=>{// Version 3.1 - AI Interviewer Integration - Force Deploy\nconst[currentStep,setCurrentStep]=useState(1);const[storyType,setStoryType]=useState('');const[storyTitle,setStoryTitle]=useState('');const[interviewMode,setInterviewMode]=useState('ai');// Default to AI mode\nconst[aiSessionId,setAiSessionId]=useState(null);const[aiMessages,setAiMessages]=useState([]);const[aiPhase,setAiPhase]=useState('discovery');const[aiStoryType,setAiStoryType]=useState(null);const[aiThemes,setAiThemes]=useState([]);const[aiQuestions,setAiQuestions]=useState([]);const[currentQuestionIndex,setCurrentQuestionIndex]=useState(0);const[answers,setAnswers]=useState({});const[uploadedFiles,setUploadedFiles]=useState([]);const[isRecording,setIsRecording]=useState(false);const[recordingTime,setRecordingTime]=useState(0);const[audioBlob,setAudioBlob]=useState(null);const[transcription,setTranscription]=useState('');const[generatedStory,setGeneratedStory]=useState('');const[editedStory,setEditedStory]=useState('');const[showPreview,setShowPreview]=useState(false);const[isLoading,setIsLoading]=useState(false);const[currentAnswer,setCurrentAnswer]=useState('');const mediaRecorderRef=useRef(null);const timerRef=useRef(null);const fileInputRef=useRef(null);// Story types with specific interview questions\nconst storyTypes={'autobiography':{name:'Autobiography',color:'bg-green-500',questions:[\"Tell me about your earliest childhood memory. What stands out most vividly?\",\"Describe your family background and the environment you grew up in.\",\"What was your education journey like? Any particular teachers or experiences that shaped you?\",\"Tell me about your first job or career path. What drew you to it?\",\"What have been the most significant relationships in your life?\",\"What challenges or obstacles have you overcome in your life?\",\"What achievements are you most proud of?\",\"How have your values and beliefs evolved over time?\",\"What legacy do you hope to leave behind?\"]},'memoir':{name:'Memoir',color:'bg-blue-500',questions:[\"What specific period or theme in your life does this memoir focus on?\",\"What was the pivotal moment that changed everything for you?\",\"Describe the setting and circumstances of this important time.\",\"Who were the key people involved in this story?\",\"What emotions were you experiencing during this period?\",\"What did you learn from this experience?\",\"How did this experience change your perspective on life?\",\"What would you tell someone going through a similar situation?\"]},'family-history':{name:'Family History',color:'bg-orange-500',questions:[\"Tell me about your family's origins. Where did your ancestors come from?\",\"What stories have been passed down through generations in your family?\",\"Describe the most interesting or colorful character in your family history.\",\"What traditions or customs have been important in your family?\",\"Tell me about any family heirlooms or meaningful objects.\",\"What challenges or hardships did your family overcome?\",\"How has your family's story influenced who you are today?\",\"What family stories do you want to preserve for future generations?\"]},'travel':{name:'Travel Stories',color:'bg-purple-500',questions:[\"What inspired you to take this particular journey?\",\"Describe the most memorable moment from your travels.\",\"What was the biggest challenge you faced while traveling?\",\"Tell me about the people you met along the way.\",\"What surprised you most about the places you visited?\",\"How did this travel experience change your perspective?\",\"What advice would you give to someone planning a similar trip?\",\"What lasting impact did this journey have on your life?\"]},'professional':{name:'Professional Journey',color:'bg-teal-500',questions:[\"What drew you to your chosen profession or industry?\",\"Describe your first day at your most significant job.\",\"What was your biggest professional challenge and how did you overcome it?\",\"Tell me about a mentor or colleague who influenced your career.\",\"What project or achievement are you most proud of professionally?\",\"How has your industry changed during your career?\",\"What lessons have you learned about leadership and teamwork?\",\"What advice would you give to someone starting in your field?\"]},'custom':{name:'Custom Story',color:'bg-pink-500',questions:[\"What is the main theme or focus of your story?\",\"What inspired you to tell this particular story?\",\"Who are the main characters or people involved?\",\"What is the setting or context of your story?\",\"What was the most significant moment or turning point?\",\"What emotions or feelings are central to this story?\",\"What message or lesson do you want to convey?\",\"Why is this story important to you and others?\"]}};// Initialize AI questions based on story type\nuseEffect(()=>{if(storyType&&storyTypes[storyType]){setAiQuestions(storyTypes[storyType].questions);setCurrentQuestionIndex(0);}},[storyType]);// Recording timer\nuseEffect(()=>{if(isRecording){timerRef.current=setInterval(()=>{setRecordingTime(prev=>prev+1);},1000);}else{clearInterval(timerRef.current);}return()=>clearInterval(timerRef.current);},[isRecording]);const formatTime=seconds=>{const mins=Math.floor(seconds/60);const secs=seconds%60;return\"\".concat(mins.toString().padStart(2,'0'),\":\").concat(secs.toString().padStart(2,'0'));};const startRecording=async()=>{try{const stream=await navigator.mediaDevices.getUserMedia({audio:true});const mediaRecorder=new MediaRecorder(stream);mediaRecorderRef.current=mediaRecorder;const chunks=[];mediaRecorder.ondataavailable=e=>chunks.push(e.data);mediaRecorder.onstop=()=>{const blob=new Blob(chunks,{type:'audio/wav'});setAudioBlob(blob);transcribeAudio(blob);};mediaRecorder.start();setIsRecording(true);setRecordingTime(0);}catch(error){console.error('Error starting recording:',error);alert('Could not access microphone. Please check permissions.');}};const stopRecording=()=>{if(mediaRecorderRef.current&&isRecording){mediaRecorderRef.current.stop();mediaRecorderRef.current.stream.getTracks().forEach(track=>track.stop());setIsRecording(false);}};const API_BASE_URL='https://xlhyimcj637n.manus.space';const transcribeAudio=async audioBlob=>{if(!audioBlob)return;setIsLoading(true);setTranscription('');// Clear any existing transcription\ntry{const formData=new FormData();formData.append('audio',audioBlob,'recording.wav');const response=await fetch(\"\".concat(API_BASE_URL,\"/api/transcribe\"),{method:'POST',body:formData,headers:{'Authorization':\"Bearer demo-token\"}});if(response.ok){const data=await response.json();const transcribedText=data.transcription||data.text;if(transcribedText){setTranscription(transcribedText);setCurrentAnswer(prev=>prev+' '+transcribedText);}else{setTranscription('Recording processed. No speech detected.');}}else{// Fallback: Let user type their response\nsetTranscription('Voice recording completed. Please type your response below or try recording again.');}}catch(error){console.error('Transcription error:',error);// Fallback: Let user type their response  \nsetTranscription('Voice recording completed. Please type your response below or try recording again.');}setIsLoading(false);};const enhanceTranscription=async originalText=>{setIsLoading(true);try{const response=await fetch(\"\".concat(API_BASE_URL,\"/api/enhance-text\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer demo-token\"},body:JSON.stringify({text:originalText,enhancement_type:'storytelling'})});if(response.ok){const data=await response.json();const enhancedText=data.enhanced_text||data.text||originalText;setTranscription(enhancedText);setCurrentAnswer(prev=>prev.replace(originalText,enhancedText));}else{// If enhancement fails, keep original\nconsole.log('Enhancement service unavailable, keeping original text');}}catch(error){console.error('Enhancement error:',error);// Keep original text if enhancement fails\n}setIsLoading(false);};const keepTranscriptionAsIs=()=>{// Transcription is already set, just confirm it's added to the answer\nif(!currentAnswer.includes(transcription)){setCurrentAnswer(prev=>prev+' '+transcription);}};const handleFileUpload=event=>{const files=Array.from(event.target.files);const newFiles=files.map(file=>({id:Date.now()+Math.random(),name:file.name,type:file.type,size:file.size,file:file,preview:file.type.startsWith('image/')?URL.createObjectURL(file):null}));setUploadedFiles(prev=>[...prev,...newFiles]);};const removeFile=fileId=>{setUploadedFiles(prev=>prev.filter(f=>f.id!==fileId));};const saveAnswer=()=>{if(currentAnswer.trim()){setAnswers(prev=>_objectSpread(_objectSpread({},prev),{},{[currentQuestionIndex]:currentAnswer.trim()}));setCurrentAnswer('');setTranscription('');setAudioBlob(null);}};const nextQuestion=()=>{saveAnswer();if(currentQuestionIndex<aiQuestions.length-1){setCurrentQuestionIndex(prev=>prev+1);}else{generateStory();}};const previousQuestion=()=>{if(currentQuestionIndex>0){setCurrentQuestionIndex(prev=>prev-1);setCurrentAnswer(answers[currentQuestionIndex-1]||'');}};const generateStory=async()=>{setIsLoading(true);setCurrentStep(5);// Simulate story generation\nsetTimeout(()=>{var _storyTypes$storyType;const sampleStory=\"# \".concat(storyTitle,\"\\n\\nThis is the beginning of your \").concat((_storyTypes$storyType=storyTypes[storyType])===null||_storyTypes$storyType===void 0?void 0:_storyTypes$storyType.name.toLowerCase(),\" story...\\n\\n\").concat(Object.values(answers).join('\\n\\n'));setGeneratedStory(sampleStory);setEditedStory(sampleStory);setIsLoading(false);},3000);};// AI Interviewer Functions\nconst startAIInterview=async()=>{setIsLoading(true);try{const response=await fetch(\"\".concat(API_BASE_URL,\"/api/lifebooks-integration\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer demo-token\"},body:JSON.stringify({action:'start_ai_interview'})});if(response.ok){const data=await response.json();if(data.success){setAiSessionId(data.session_id);setAiMessages([{role:'ai',content:data.initial_message,timestamp:new Date().toISOString()}]);setInterviewMode('ai');setCurrentStep(3);}}else{var _storyTypes$storyType2;console.error('Failed to start AI interview');// Fallback to traditional interview\nsetInterviewMode('traditional');setAiQuestions(((_storyTypes$storyType2=storyTypes[storyType])===null||_storyTypes$storyType2===void 0?void 0:_storyTypes$storyType2.questions)||[]);setCurrentStep(3);}}catch(error){var _storyTypes$storyType3;console.error('Error starting AI interview:',error);// Fallback to traditional interview\nsetInterviewMode('traditional');setAiQuestions(((_storyTypes$storyType3=storyTypes[storyType])===null||_storyTypes$storyType3===void 0?void 0:_storyTypes$storyType3.questions)||[]);setCurrentStep(3);}setIsLoading(false);};const sendAIMessage=async message=>{if(!message.trim()||!aiSessionId)return;// Add user message to conversation\nconst userMessage={role:'user',content:message,timestamp:new Date().toISOString()};setAiMessages(prev=>[...prev,userMessage]);setCurrentAnswer('');setIsLoading(true);try{const response=await fetch(\"\".concat(API_BASE_URL,\"/api/process-response\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer demo-token\"},body:JSON.stringify({session_id:aiSessionId,message:message})});if(response.ok){const data=await response.json();// Add AI response to conversation\nconst aiMessage={role:'ai',content:data.message,timestamp:new Date().toISOString()};setAiMessages(prev=>[...prev,aiMessage]);// Update interview state\nsetAiPhase(data.phase);setAiStoryType(data.story_type);setAiThemes(data.themes||[]);// Check if interview is complete\nif(data.phase==='wisdom_extraction'&&data.message.includes('ready for me to begin crafting')){// Interview complete, offer to generate book\nsetTimeout(()=>{setCurrentStep(4);},2000);}}else{console.error('Failed to process AI response');}}catch(error){console.error('Error sending AI message:',error);}setIsLoading(false);};const generateAIBookOutline=async()=>{if(!aiSessionId)return;setIsLoading(true);try{const response=await fetch(\"\".concat(API_BASE_URL,\"/api/generate-outline\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer demo-token\"},body:JSON.stringify({session_id:aiSessionId})});if(response.ok){var _outline$themes,_outline$chapters;const outline=await response.json();// Convert outline to story format\nconst storyContent=\"# \".concat(outline.title||storyTitle,\"\\n\\n## Book Outline\\n\\n**Story Type:** \").concat(outline.book_type,\"\\n**Estimated Length:** \").concat(outline.estimated_length,\"\\n**Key Themes:** \").concat((_outline$themes=outline.themes)===null||_outline$themes===void 0?void 0:_outline$themes.join(', '),\"\\n\\n### Chapters:\\n\\n\").concat(((_outline$chapters=outline.chapters)===null||_outline$chapters===void 0?void 0:_outline$chapters.map((chapter,index)=>\"**Chapter \".concat(index+1,\": \").concat(chapter.title,\"**\\n\").concat(chapter.theme,\"\\n\")).join('\\n'))||'Chapters will be generated based on your interview content.',\"\\n\\n## Your Story\\n\\nBased on our conversation, here's the beginning of your story...\\n\\n\").concat(aiMessages.filter(msg=>msg.role==='user').map(msg=>msg.content).join('\\n\\n'));setGeneratedStory(storyContent);setEditedStory(storyContent);setCurrentStep(5);}}catch(error){console.error('Error generating AI book outline:',error);}setIsLoading(false);};const generateStoryFromTraditional=async()=>{setIsLoading(true);setCurrentStep(4);try{const response=await fetch(\"\".concat(API_BASE_URL,\"/api/generate-story\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(localStorage.getItem('token'))},body:JSON.stringify({storyType,title:storyTitle,answers,uploadedFiles:uploadedFiles.map(f=>({name:f.name,type:f.type}))})});if(response.ok){const data=await response.json();setGeneratedStory(data.story);setEditedStory(data.story);}else{const errorData=await response.json();console.error('Story generation error:',errorData.message);alert(\"Story generation failed: \".concat(errorData.message));// Fallback to demo story\nconst demoStory=\"# \".concat(storyTitle,\"\\n\\nBased on your responses, here is your personalized story...\\n\\n\").concat(Object.values(answers).join('\\n\\n'));setGeneratedStory(demoStory);setEditedStory(demoStory);}}catch(error){console.error('Story generation error:',error);alert('Story generation failed. Please try again.');// Fallback demo story\nconst demoStory=\"# \".concat(storyTitle,\"\\n\\nBased on your responses, here is your personalized story...\\n\\n\").concat(Object.values(answers).join('\\n\\n'));setGeneratedStory(demoStory);setEditedStory(demoStory);}setIsLoading(false);};const saveStory=async()=>{setIsLoading(true);try{const response=await fetch(\"\".concat(API_BASE_URL,\"/api/story\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(localStorage.getItem('token'))},body:JSON.stringify({title:storyTitle,content:editedStory,summary:\"\".concat(storyType,\" story created through AI interview process\"),tags:[storyType,'ai-generated','interview']})});if(response.ok){const data=await response.json();alert('Story saved successfully!');console.log('Saved story:',data.story);}else{const errorData=await response.json();console.error('Save error:',errorData.message);alert(\"Save failed: \".concat(errorData.message));}}catch(error){console.error('Save error:',error);alert('Story saved locally! (Network error occurred)');}setIsLoading(false);};const renderStepIndicator=()=>/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center mb-8\",children:[1,2,3,4,5].map(step=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold \".concat(currentStep>=step?'bg-orange-500':'bg-gray-300'),children:currentStep>step?'✓':step}),step<5&&/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-1 \".concat(currentStep>step?'bg-orange-500':'bg-gray-300')})]},step))});const renderStoryTypeSelection=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-center mb-8\",children:\"Choose Your Story Type\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\",children:Object.entries(storyTypes).map(_ref=>{let[key,type]=_ref;return/*#__PURE__*/_jsxs(\"div\",{onClick:()=>{setStoryType(key);setCurrentStep(2);},className:\"story-type-card \".concat(storyType===key?'selected':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 rounded-lg \".concat(type.color,\" mb-4 flex items-center justify-center\"),children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white text-2xl\",children:\"\\uD83D\\uDCD6\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold mb-2\",children:type.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 text-sm\",children:[key==='autobiography'&&'Tell your complete life story from childhood to present',key==='memoir'&&'Focus on a specific period or theme in your life',key==='family-history'&&'Preserve your family heritage and traditions',key==='travel'&&'Share your adventures and travel experiences',key==='professional'&&'Document your career journey and achievements',key==='custom'&&'Create a personalized story on any topic']})]},key);})})]});const renderStorySetup=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-2xl mx-auto\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-center mb-8\",children:\"Story Setup\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-lg font-medium mb-2\",children:\"Story Title\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:storyTitle,onChange:e=>setStoryTitle(e.target.value),placeholder:\"Enter a title for your story...\",className:\"w-full p-4 border border-gray-300 rounded-lg text-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-lg font-medium mb-2\",children:\"Upload Supporting Materials (Optional)\"}),/*#__PURE__*/_jsxs(\"div\",{onClick:()=>{var _fileInputRef$current;return(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();},className:\"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-orange-500 transition-colors\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-6xl mb-4 block\",children:\"\\uD83D\\uDCC1\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg text-gray-600\",children:\"Click to upload photos, documents, or other files\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mt-2\",children:\"Supports images, PDFs, and text documents\"})]}),/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",multiple:true,accept:\"image/*,.pdf,.doc,.docx,.txt\",onChange:handleFileUpload,className:\"hidden\"})]}),uploadedFiles.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium\",children:\"Uploaded Files:\"}),uploadedFiles.map(file=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[file.preview?/*#__PURE__*/_jsx(\"img\",{src:file.preview,alt:file.name,className:\"w-12 h-12 object-cover rounded\"}):/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl\",children:\"\\uD83D\\uDCC4\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium\",children:file.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[(file.size/1024/1024).toFixed(2),\" MB\"]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeFile(file.id),className:\"text-red-500 hover:text-red-700\",children:\"Remove\"})]},file.id))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-center\",children:\"Choose Your Interview Experience\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:startAIInterview,disabled:!storyTitle.trim(),className:\"p-6 bg-gradient-to-r from-purple-500 to-blue-500 text-white rounded-lg font-semibold hover:from-purple-600 hover:to-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-all transform hover:scale-105\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-3xl mb-2\",children:\"\\uD83E\\uDD16\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-lg font-bold mb-2\",children:\"AI Ghostwriter Interview\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm opacity-90\",children:\"Professional ghostwriter-style conversation that adapts to your responses and guides you through your story naturally\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _storyTypes$storyType4;setInterviewMode('traditional');setAiQuestions(((_storyTypes$storyType4=storyTypes[storyType])===null||_storyTypes$storyType4===void 0?void 0:_storyTypes$storyType4.questions)||[]);setCurrentStep(3);},disabled:!storyTitle.trim(),className:\"p-6 bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-lg font-semibold hover:from-orange-600 hover:to-red-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-all transform hover:scale-105\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-3xl mb-2\",children:\"\\uD83D\\uDCDD\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-lg font-bold mb-2\",children:\"Traditional Q&A\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm opacity-90\",children:\"Structured questions specific to your story type with voice recording and document upload\"})]})]})]})]})]});const renderAIInterview=()=>{if(interviewMode==='ai'){return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto h-screen flex flex-col\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white border-b border-gray-200 p-4 flex-shrink-0\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white text-lg\",children:\"\\uD83E\\uDD16\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-gray-900\",children:\"AI Ghostwriter\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[\"Phase: \",aiPhase.replace('_',' '),\" \\u2022 \",aiStoryType?aiStoryType.replace('_',' '):'Discovering your story']})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[aiThemes.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-1\",children:[aiThemes.slice(0,3).map((theme,index)=>/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 bg-orange-100 text-orange-700 rounded-full text-xs\",children:theme},index)),aiThemes.length>3&&/*#__PURE__*/_jsxs(\"span\",{className:\"px-2 py-1 bg-gray-100 text-gray-600 rounded-full text-xs\",children:[\"+\",aiThemes.length-3]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentStep(4),className:\"px-3 py-1 bg-green-500 text-white rounded-lg text-sm hover:bg-green-600\",children:\"Generate Book\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-container\",children:[aiMessages.map((message,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"chat-message \".concat(message.role),children:/*#__PURE__*/_jsxs(\"div\",{className:\"chat-bubble \".concat(message.role),children:[/*#__PURE__*/_jsx(\"div\",{className:\"whitespace-pre-wrap\",children:message.content}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs mt-1 opacity-70\",children:new Date(message.timestamp).toLocaleTimeString()}),message.role==='user'&&message.enhanced!==true&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>enhanceMessage(index,message.content),className:\"text-xs bg-white bg-opacity-20 hover:bg-opacity-30 px-2 py-1 rounded\",disabled:isLoading,children:\"\\u2728 Enhance\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>editMessage(index),className:\"text-xs bg-white bg-opacity-20 hover:bg-opacity-30 px-2 py-1 rounded\",children:\"\\u270F\\uFE0F Edit\"})]})]})},index)),isLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-start\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white text-gray-800 shadow-sm border px-4 py-3 rounded-lg max-w-xs\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\"}),/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\",style:{animationDelay:'0.1s'}}),/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\",style:{animationDelay:'0.2s'}})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-500\",children:\"AI is thinking...\"})]})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white border-t border-gray-200 p-4 flex-shrink-0\",children:[transcription&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3 p-3 bg-blue-50 border border-blue-200 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-2\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-blue-800 text-sm\",children:\"\\uD83C\\uDFA4 Voice Transcription:\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setTranscription(''),className:\"text-blue-600 hover:text-blue-800 text-sm\",children:\"\\u2715\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-blue-700 text-sm mb-3\",children:transcription}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>enhanceTranscription(transcription),className:\"px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600 disabled:bg-gray-300\",disabled:isLoading,children:\"\\u2728 Enhance & Use\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setCurrentAnswer(transcription);setTranscription('');},className:\"px-3 py-1 bg-gray-500 text-white rounded text-sm hover:bg-gray-600\",children:\"Use As Is\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-input-container\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:currentAnswer,onChange:e=>setCurrentAnswer(e.target.value),placeholder:\"Share your thoughts... (or use voice recording)\",className:\"chat-input\",rows:\"3\",onKeyPress:e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();if(currentAnswer.trim()){sendAIMessage(currentAnswer);}}}}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col space-y-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:isRecording?stopRecording:startRecording,className:\"voice-recording-btn \".concat(isRecording?'recording':''),title:isRecording?\"Recording \".concat(formatTime(recordingTime)):'Start voice recording',children:[/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",fill:\"currentColor\",children:isRecording?/*#__PURE__*/_jsx(\"rect\",{x:\"6\",y:\"6\",width:\"12\",height:\"12\",rx:\"2\"}):/*#__PURE__*/_jsx(\"path\",{d:\"M12 2a3 3 0 0 0-3 3v6a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z\"})}),isRecording?'🛑':'🎤']}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>sendAIMessage(currentAnswer),disabled:!currentAnswer.trim()||isLoading,className:\"chat-send-btn\",title:\"Send message\",children:\"\\u27A4\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mt-3 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>sendAIMessage(\"I'd like to skip this question and come back to it later.\"),className:\"text-gray-600 hover:text-purple-600 transition-colors\",disabled:isLoading,children:\"\\u23ED\\uFE0F Skip Question\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>sendAIMessage(\"Can we go back to a previous topic?\"),className:\"text-gray-600 hover:text-purple-600 transition-colors\",disabled:isLoading,children:\"\\u2B05\\uFE0F Go Back\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>sendAIMessage(\"I need a moment to think about this.\"),className:\"text-gray-600 hover:text-purple-600 transition-colors\",disabled:isLoading,children:\"\\u23F8\\uFE0F Pause\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-500\",children:\"Press Enter to send \\u2022 Shift+Enter for new line\"})]}),audioBlob&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{const audio=new Audio(URL.createObjectURL(audioBlob));audio.play();},className:\"flex items-center space-x-1 px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u25B6\\uFE0F\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Play Recording\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setAudioBlob(null),className:\"text-gray-500 hover:text-red-500 text-sm\",children:\"Delete\"})]})]})]});}else{// Traditional Q&A Mode\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"max-w-4xl mx-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-lg p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-900\",children:\"Traditional Q&A Interview\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm\",children:[\"Question \",currentQuestionIndex+1,\" of \",aiQuestions.length]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-500 h-2 rounded-full transition-all duration-300\",style:{width:\"\".concat((currentQuestionIndex+1)/aiQuestions.length*100,\"%\")}})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-medium text-gray-800 mb-4\",children:aiQuestions[currentQuestionIndex]}),/*#__PURE__*/_jsx(\"textarea\",{value:currentAnswer,onChange:e=>setCurrentAnswer(e.target.value),placeholder:\"Share your thoughts here...\",className:\"w-full p-4 border border-gray-300 rounded-lg h-32 text-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:isRecording?stopRecording:startRecording,className:\"flex items-center space-x-2 px-6 py-3 rounded-lg font-semibold transition-colors \".concat(isRecording?'bg-red-500 text-white hover:bg-red-600':'bg-blue-500 text-white hover:bg-blue-600'),children:[/*#__PURE__*/_jsx(\"span\",{children:isRecording?'🛑':'🎤'}),/*#__PURE__*/_jsx(\"span\",{children:isRecording?\"Recording \".concat(formatTime(recordingTime)):'Voice Recording'})]}),audioBlob&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{const audio=new Audio(URL.createObjectURL(audioBlob));audio.play();},className:\"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u25B6\\uFE0F\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Play Recording\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:previousQuestion,disabled:currentQuestionIndex===0,className:\"px-6 py-3 bg-gray-500 text-white rounded-lg font-semibold hover:bg-gray-600 disabled:bg-gray-300 disabled:cursor-not-allowed\",children:\"Previous\"}),/*#__PURE__*/_jsx(\"button\",{onClick:nextQuestion,className:\"px-6 py-3 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600\",children:currentQuestionIndex===aiQuestions.length-1?'Finish':'Next'})]})]}),transcription&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-green-800 mb-2\",children:\"\\uD83C\\uDFA4 Transcription:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-green-700 mb-3\",children:transcription}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>enhanceTranscription(transcription),className:\"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:bg-gray-300\",disabled:isLoading,children:\"\\u2728 Enhance with AI\"}),/*#__PURE__*/_jsx(\"button\",{onClick:keepTranscriptionAsIs,className:\"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600\",children:\"\\u2713 Keep As Is\"})]})]})]})});}};// Enhanced message functions for chatbot interface\nconst enhanceMessage=async(messageIndex,content)=>{setIsLoading(true);try{const response=await fetch(\"\".concat(API_BASE_URL,\"/api/enhance-text\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':'Bearer demo-token'},body:JSON.stringify({text:content,enhancement_type:'storytelling'})});if(response.ok){const data=await response.json();const updatedMessages=[...aiMessages];updatedMessages[messageIndex]=_objectSpread(_objectSpread({},updatedMessages[messageIndex]),{},{content:data.enhanced_text,enhanced:true});setAiMessages(updatedMessages);}else{alert('Enhancement failed. Please try again.');}}catch(error){console.error('Enhancement error:',error);alert('Enhancement failed. Please try again.');}finally{setIsLoading(false);}};const editMessage=messageIndex=>{const message=aiMessages[messageIndex];const newContent=prompt('Edit your message:',message.content);if(newContent&&newContent!==message.content){const updatedMessages=[...aiMessages];updatedMessages[messageIndex]=_objectSpread(_objectSpread({},updatedMessages[messageIndex]),{},{content:newContent});setAiMessages(updatedMessages);}};const renderStoryGeneration=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-center mb-8\",children:\"Your Generated Story\"}),isLoading?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-16 w-16 border-b-2 border-orange-500 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg text-gray-600\",children:\"AI is crafting your story...\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold\",children:\"Story Preview\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-x-4\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowPreview(!showPreview),className:\"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDC41\\uFE0F\"}),/*#__PURE__*/_jsx(\"span\",{children:showPreview?'Edit Mode':'Preview Mode'})]})})]}),showPreview?/*#__PURE__*/_jsx(\"div\",{className:\"prose max-w-none p-6 bg-white rounded-lg shadow-lg\",children:/*#__PURE__*/_jsx(\"div\",{dangerouslySetInnerHTML:{__html:editedStory.replace(/\\n/g,'<br>')}})}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-lg font-medium mb-2\",children:\"Edit Your Story\"}),/*#__PURE__*/_jsx(\"textarea\",{value:editedStory,onChange:e=>setEditedStory(e.target.value),className:\"w-full p-4 border border-gray-300 rounded-lg h-96 text-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setCurrentStep(3),className:\"flex items-center space-x-2 px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u2B05\\uFE0F\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Back to Interview\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-x-4\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setCurrentStep(5),className:\"flex items-center space-x-2 px-6 py-3 bg-orange-500 text-white rounded-lg hover:bg-orange-600\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Finalize Story\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u27A1\\uFE0F\"})]})})]})]})]});const renderStoryFinalization=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-center mb-8\",children:\"Story Complete!\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-lg p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-6xl mb-4 block\",children:\"\\u2705\"}),/*#__PURE__*/_jsxs(\"h3\",{className:\"text-2xl font-semibold mb-2\",children:[\"Your story \\\"\",storyTitle,\"\\\" is ready!\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Choose what you'd like to do next with your story.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:saveStory,className:\"flex items-center justify-center space-x-3 p-6 border-2 border-orange-500 rounded-lg hover:bg-orange-50 transition-colors\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-orange-500 text-2xl\",children:\"\\uD83D\\uDCBE\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-left\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold\",children:\"Save Story\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Save to your dashboard for later editing\"})]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>alert('Book cover creation feature coming soon!'),className:\"flex items-center justify-center space-x-3 p-6 border-2 border-blue-500 rounded-lg hover:bg-blue-50 transition-colors\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-blue-500 text-2xl\",children:\"\\uD83D\\uDCF7\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-left\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold\",children:\"Create Book Cover\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Design a beautiful cover for your story\"})]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>alert('Publishing feature coming soon!'),className:\"flex items-center justify-center space-x-3 p-6 border-2 border-green-500 rounded-lg hover:bg-green-50 transition-colors\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-green-500 text-2xl\",children:\"\\uD83D\\uDCDA\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-left\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold\",children:\"Publish Book\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Publish to Amazon KDP or other platforms\"})]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{const element=document.createElement('a');const file=new Blob([editedStory],{type:'text/plain'});element.href=URL.createObjectURL(file);element.download=\"\".concat(storyTitle,\".txt\");document.body.appendChild(element);element.click();document.body.removeChild(element);},className:\"flex items-center justify-center space-x-3 p-6 border-2 border-purple-500 rounded-lg hover:bg-purple-50 transition-colors\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-purple-500 text-2xl\",children:\"\\u2B07\\uFE0F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-left\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold\",children:\"Download Story\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Download as text file or PDF\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-8 text-center\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setCurrentStep(1);setStoryType('');setStoryTitle('');setAnswers({});setUploadedFiles([]);setGeneratedStory('');setEditedStory('');setCurrentQuestionIndex(0);},className:\"px-8 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors\",children:\"Create Another Story\"})})]})]});return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gradient-to-br from-orange-400 via-orange-500 to-orange-600 py-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4\",children:[renderStepIndicator(),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 rounded-lg shadow-xl p-8\",children:[currentStep===1&&renderStoryTypeSelection(),currentStep===2&&renderStorySetup(),currentStep===3&&renderAIInterview(),currentStep===4&&renderStoryGeneration(),currentStep===5&&renderStoryFinalization()]})]})});};export default StoryCreator;","map":{"version":3,"names":["React","useState","useEffect","useRef","jsx","_jsx","jsxs","_jsxs","StoryCreator","currentStep","setCurrentStep","storyType","setStoryType","storyTitle","setStoryTitle","interviewMode","setInterviewMode","aiSessionId","setAiSessionId","aiMessages","setAiMessages","aiPhase","setAiPhase","aiStoryType","setAiStoryType","aiThemes","setAiThemes","aiQuestions","setAiQuestions","currentQuestionIndex","setCurrentQuestionIndex","answers","setAnswers","uploadedFiles","setUploadedFiles","isRecording","setIsRecording","recordingTime","setRecordingTime","audioBlob","setAudioBlob","transcription","setTranscription","generatedStory","setGeneratedStory","editedStory","setEditedStory","showPreview","setShowPreview","isLoading","setIsLoading","currentAnswer","setCurrentAnswer","mediaRecorderRef","timerRef","fileInputRef","storyTypes","name","color","questions","current","setInterval","prev","clearInterval","formatTime","seconds","mins","Math","floor","secs","concat","toString","padStart","startRecording","stream","navigator","mediaDevices","getUserMedia","audio","mediaRecorder","MediaRecorder","chunks","ondataavailable","e","push","data","onstop","blob","Blob","type","transcribeAudio","start","error","console","alert","stopRecording","stop","getTracks","forEach","track","API_BASE_URL","formData","FormData","append","response","fetch","method","body","headers","ok","json","transcribedText","text","enhanceTranscription","originalText","JSON","stringify","enhancement_type","enhancedText","enhanced_text","replace","log","keepTranscriptionAsIs","includes","handleFileUpload","event","files","Array","from","target","newFiles","map","file","id","Date","now","random","size","preview","startsWith","URL","createObjectURL","removeFile","fileId","filter","f","saveAnswer","trim","_objectSpread","nextQuestion","length","generateStory","previousQuestion","setTimeout","_storyTypes$storyType","sampleStory","toLowerCase","Object","values","join","startAIInterview","action","success","session_id","role","content","initial_message","timestamp","toISOString","_storyTypes$storyType2","_storyTypes$storyType3","sendAIMessage","message","userMessage","aiMessage","phase","story_type","themes","generateAIBookOutline","_outline$themes","_outline$chapters","outline","storyContent","title","book_type","estimated_length","chapters","chapter","index","theme","msg","generateStoryFromTraditional","localStorage","getItem","story","errorData","demoStory","saveStory","summary","tags","renderStepIndicator","className","children","step","renderStoryTypeSelection","entries","_ref","key","onClick","renderStorySetup","value","onChange","placeholder","_fileInputRef$current","click","ref","multiple","accept","src","alt","toFixed","disabled","_storyTypes$storyType4","renderAIInterview","slice","toLocaleTimeString","enhanced","enhanceMessage","editMessage","style","animationDelay","rows","onKeyPress","shiftKey","preventDefault","viewBox","fill","x","y","width","height","rx","d","Audio","play","messageIndex","updatedMessages","newContent","prompt","renderStoryGeneration","dangerouslySetInnerHTML","__html","renderStoryFinalization","element","document","createElement","href","download","appendChild","removeChild"],"sources":["/home/ubuntu/lifebooks-ai/lifebooks-frontend/src/components/StoryCreator.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\n\nconst StoryCreator = () => {\n  // Version 3.1 - AI Interviewer Integration - Force Deploy\n  const [currentStep, setCurrentStep] = useState(1);\n  const [storyType, setStoryType] = useState('');\n  const [storyTitle, setStoryTitle] = useState('');\n  const [interviewMode, setInterviewMode] = useState('ai'); // Default to AI mode\n  const [aiSessionId, setAiSessionId] = useState(null);\n  const [aiMessages, setAiMessages] = useState([]);\n  const [aiPhase, setAiPhase] = useState('discovery');\n  const [aiStoryType, setAiStoryType] = useState(null);\n  const [aiThemes, setAiThemes] = useState([]);\n  const [aiQuestions, setAiQuestions] = useState([]);\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\n  const [answers, setAnswers] = useState({});\n  const [uploadedFiles, setUploadedFiles] = useState([]);\n  const [isRecording, setIsRecording] = useState(false);\n  const [recordingTime, setRecordingTime] = useState(0);\n  const [audioBlob, setAudioBlob] = useState(null);\n  const [transcription, setTranscription] = useState('');\n  const [generatedStory, setGeneratedStory] = useState('');\n  const [editedStory, setEditedStory] = useState('');\n  const [showPreview, setShowPreview] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [currentAnswer, setCurrentAnswer] = useState('');\n  \n  const mediaRecorderRef = useRef(null);\n  const timerRef = useRef(null);\n  const fileInputRef = useRef(null);\n\n  // Story types with specific interview questions\n  const storyTypes = {\n    'autobiography': {\n      name: 'Autobiography',\n      color: 'bg-green-500',\n      questions: [\n        \"Tell me about your earliest childhood memory. What stands out most vividly?\",\n        \"Describe your family background and the environment you grew up in.\",\n        \"What was your education journey like? Any particular teachers or experiences that shaped you?\",\n        \"Tell me about your first job or career path. What drew you to it?\",\n        \"What have been the most significant relationships in your life?\",\n        \"What challenges or obstacles have you overcome in your life?\",\n        \"What achievements are you most proud of?\",\n        \"How have your values and beliefs evolved over time?\",\n        \"What legacy do you hope to leave behind?\"\n      ]\n    },\n    'memoir': {\n      name: 'Memoir',\n      color: 'bg-blue-500',\n      questions: [\n        \"What specific period or theme in your life does this memoir focus on?\",\n        \"What was the pivotal moment that changed everything for you?\",\n        \"Describe the setting and circumstances of this important time.\",\n        \"Who were the key people involved in this story?\",\n        \"What emotions were you experiencing during this period?\",\n        \"What did you learn from this experience?\",\n        \"How did this experience change your perspective on life?\",\n        \"What would you tell someone going through a similar situation?\"\n      ]\n    },\n    'family-history': {\n      name: 'Family History',\n      color: 'bg-orange-500',\n      questions: [\n        \"Tell me about your family's origins. Where did your ancestors come from?\",\n        \"What stories have been passed down through generations in your family?\",\n        \"Describe the most interesting or colorful character in your family history.\",\n        \"What traditions or customs have been important in your family?\",\n        \"Tell me about any family heirlooms or meaningful objects.\",\n        \"What challenges or hardships did your family overcome?\",\n        \"How has your family's story influenced who you are today?\",\n        \"What family stories do you want to preserve for future generations?\"\n      ]\n    },\n    'travel': {\n      name: 'Travel Stories',\n      color: 'bg-purple-500',\n      questions: [\n        \"What inspired you to take this particular journey?\",\n        \"Describe the most memorable moment from your travels.\",\n        \"What was the biggest challenge you faced while traveling?\",\n        \"Tell me about the people you met along the way.\",\n        \"What surprised you most about the places you visited?\",\n        \"How did this travel experience change your perspective?\",\n        \"What advice would you give to someone planning a similar trip?\",\n        \"What lasting impact did this journey have on your life?\"\n      ]\n    },\n    'professional': {\n      name: 'Professional Journey',\n      color: 'bg-teal-500',\n      questions: [\n        \"What drew you to your chosen profession or industry?\",\n        \"Describe your first day at your most significant job.\",\n        \"What was your biggest professional challenge and how did you overcome it?\",\n        \"Tell me about a mentor or colleague who influenced your career.\",\n        \"What project or achievement are you most proud of professionally?\",\n        \"How has your industry changed during your career?\",\n        \"What lessons have you learned about leadership and teamwork?\",\n        \"What advice would you give to someone starting in your field?\"\n      ]\n    },\n    'custom': {\n      name: 'Custom Story',\n      color: 'bg-pink-500',\n      questions: [\n        \"What is the main theme or focus of your story?\",\n        \"What inspired you to tell this particular story?\",\n        \"Who are the main characters or people involved?\",\n        \"What is the setting or context of your story?\",\n        \"What was the most significant moment or turning point?\",\n        \"What emotions or feelings are central to this story?\",\n        \"What message or lesson do you want to convey?\",\n        \"Why is this story important to you and others?\"\n      ]\n    }\n  };\n\n  // Initialize AI questions based on story type\n  useEffect(() => {\n    if (storyType && storyTypes[storyType]) {\n      setAiQuestions(storyTypes[storyType].questions);\n      setCurrentQuestionIndex(0);\n    }\n  }, [storyType]);\n\n  // Recording timer\n  useEffect(() => {\n    if (isRecording) {\n      timerRef.current = setInterval(() => {\n        setRecordingTime(prev => prev + 1);\n      }, 1000);\n    } else {\n      clearInterval(timerRef.current);\n    }\n    return () => clearInterval(timerRef.current);\n  }, [isRecording]);\n\n  const formatTime = (seconds) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const startRecording = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n      const mediaRecorder = new MediaRecorder(stream);\n      mediaRecorderRef.current = mediaRecorder;\n      \n      const chunks = [];\n      mediaRecorder.ondataavailable = (e) => chunks.push(e.data);\n      mediaRecorder.onstop = () => {\n        const blob = new Blob(chunks, { type: 'audio/wav' });\n        setAudioBlob(blob);\n        transcribeAudio(blob);\n      };\n      \n      mediaRecorder.start();\n      setIsRecording(true);\n      setRecordingTime(0);\n    } catch (error) {\n      console.error('Error starting recording:', error);\n      alert('Could not access microphone. Please check permissions.');\n    }\n  };\n\n  const stopRecording = () => {\n    if (mediaRecorderRef.current && isRecording) {\n      mediaRecorderRef.current.stop();\n      mediaRecorderRef.current.stream.getTracks().forEach(track => track.stop());\n      setIsRecording(false);\n    }\n  };\n\n  const API_BASE_URL = 'https://xlhyimcj637n.manus.space';\n  \n  const transcribeAudio = async (audioBlob) => {\n    if (!audioBlob) return;\n    \n    setIsLoading(true);\n    setTranscription(''); // Clear any existing transcription\n    \n    try {\n      const formData = new FormData();\n      formData.append('audio', audioBlob, 'recording.wav');\n      \n      const response = await fetch(`${API_BASE_URL}/api/transcribe`, {\n        method: 'POST',\n        body: formData,\n        headers: {\n          'Authorization': `Bearer demo-token`\n        }\n      });\n      \n      if (response.ok) {\n        const data = await response.json();\n        const transcribedText = data.transcription || data.text;\n        if (transcribedText) {\n          setTranscription(transcribedText);\n          setCurrentAnswer(prev => prev + ' ' + transcribedText);\n        } else {\n          setTranscription('Recording processed. No speech detected.');\n        }\n      } else {\n        // Fallback: Let user type their response\n        setTranscription('Voice recording completed. Please type your response below or try recording again.');\n      }\n    } catch (error) {\n      console.error('Transcription error:', error);\n      // Fallback: Let user type their response  \n      setTranscription('Voice recording completed. Please type your response below or try recording again.');\n    }\n    setIsLoading(false);\n  };\n\n  const enhanceTranscription = async (originalText) => {\n    setIsLoading(true);\n    try {\n      const response = await fetch(`${API_BASE_URL}/api/enhance-text`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer demo-token`\n        },\n        body: JSON.stringify({\n          text: originalText,\n          enhancement_type: 'storytelling'\n        })\n      });\n      \n      if (response.ok) {\n        const data = await response.json();\n        const enhancedText = data.enhanced_text || data.text || originalText;\n        setTranscription(enhancedText);\n        setCurrentAnswer(prev => prev.replace(originalText, enhancedText));\n      } else {\n        // If enhancement fails, keep original\n        console.log('Enhancement service unavailable, keeping original text');\n      }\n    } catch (error) {\n      console.error('Enhancement error:', error);\n      // Keep original text if enhancement fails\n    }\n    setIsLoading(false);\n  };\n\n  const keepTranscriptionAsIs = () => {\n    // Transcription is already set, just confirm it's added to the answer\n    if (!currentAnswer.includes(transcription)) {\n      setCurrentAnswer(prev => prev + ' ' + transcription);\n    }\n  };\n\n  const handleFileUpload = (event) => {\n    const files = Array.from(event.target.files);\n    const newFiles = files.map(file => ({\n      id: Date.now() + Math.random(),\n      name: file.name,\n      type: file.type,\n      size: file.size,\n      file: file,\n      preview: file.type.startsWith('image/') ? URL.createObjectURL(file) : null\n    }));\n    setUploadedFiles(prev => [...prev, ...newFiles]);\n  };\n\n  const removeFile = (fileId) => {\n    setUploadedFiles(prev => prev.filter(f => f.id !== fileId));\n  };\n\n  const saveAnswer = () => {\n    if (currentAnswer.trim()) {\n      setAnswers(prev => ({\n        ...prev,\n        [currentQuestionIndex]: currentAnswer.trim()\n      }));\n      setCurrentAnswer('');\n      setTranscription('');\n      setAudioBlob(null);\n    }\n  };\n\n  const nextQuestion = () => {\n    saveAnswer();\n    if (currentQuestionIndex < aiQuestions.length - 1) {\n      setCurrentQuestionIndex(prev => prev + 1);\n    } else {\n      generateStory();\n    }\n  };\n\n  const previousQuestion = () => {\n    if (currentQuestionIndex > 0) {\n      setCurrentQuestionIndex(prev => prev - 1);\n      setCurrentAnswer(answers[currentQuestionIndex - 1] || '');\n    }\n  };\n\n  const generateStory = async () => {\n    setIsLoading(true);\n    setCurrentStep(5);\n    \n    // Simulate story generation\n    setTimeout(() => {\n      const sampleStory = `# ${storyTitle}\\n\\nThis is the beginning of your ${storyTypes[storyType]?.name.toLowerCase()} story...\\n\\n${Object.values(answers).join('\\n\\n')}`;\n      setGeneratedStory(sampleStory);\n      setEditedStory(sampleStory);\n      setIsLoading(false);\n    }, 3000);\n  };\n\n  // AI Interviewer Functions\n  const startAIInterview = async () => {\n    setIsLoading(true);\n    try {\n      const response = await fetch(`${API_BASE_URL}/api/lifebooks-integration`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer demo-token`\n        },\n        body: JSON.stringify({\n          action: 'start_ai_interview'\n        })\n      });\n      \n      if (response.ok) {\n        const data = await response.json();\n        if (data.success) {\n          setAiSessionId(data.session_id);\n          setAiMessages([{\n            role: 'ai',\n            content: data.initial_message,\n            timestamp: new Date().toISOString()\n          }]);\n          setInterviewMode('ai');\n          setCurrentStep(3);\n        }\n      } else {\n        console.error('Failed to start AI interview');\n        // Fallback to traditional interview\n        setInterviewMode('traditional');\n        setAiQuestions(storyTypes[storyType]?.questions || []);\n        setCurrentStep(3);\n      }\n    } catch (error) {\n      console.error('Error starting AI interview:', error);\n      // Fallback to traditional interview\n      setInterviewMode('traditional');\n      setAiQuestions(storyTypes[storyType]?.questions || []);\n      setCurrentStep(3);\n    }\n    setIsLoading(false);\n  };\n\n  const sendAIMessage = async (message) => {\n    if (!message.trim() || !aiSessionId) return;\n    \n    // Add user message to conversation\n    const userMessage = {\n      role: 'user',\n      content: message,\n      timestamp: new Date().toISOString()\n    };\n    setAiMessages(prev => [...prev, userMessage]);\n    setCurrentAnswer('');\n    setIsLoading(true);\n    \n    try {\n      const response = await fetch(`${API_BASE_URL}/api/process-response`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer demo-token`\n        },\n        body: JSON.stringify({\n          session_id: aiSessionId,\n          message: message\n        })\n      });\n      \n      if (response.ok) {\n        const data = await response.json();\n        \n        // Add AI response to conversation\n        const aiMessage = {\n          role: 'ai',\n          content: data.message,\n          timestamp: new Date().toISOString()\n        };\n        setAiMessages(prev => [...prev, aiMessage]);\n        \n        // Update interview state\n        setAiPhase(data.phase);\n        setAiStoryType(data.story_type);\n        setAiThemes(data.themes || []);\n        \n        // Check if interview is complete\n        if (data.phase === 'wisdom_extraction' && data.message.includes('ready for me to begin crafting')) {\n          // Interview complete, offer to generate book\n          setTimeout(() => {\n            setCurrentStep(4);\n          }, 2000);\n        }\n      } else {\n        console.error('Failed to process AI response');\n      }\n    } catch (error) {\n      console.error('Error sending AI message:', error);\n    }\n    setIsLoading(false);\n  };\n\n  const generateAIBookOutline = async () => {\n    if (!aiSessionId) return;\n    \n    setIsLoading(true);\n    try {\n      const response = await fetch(`${API_BASE_URL}/api/generate-outline`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer demo-token`\n        },\n        body: JSON.stringify({\n          session_id: aiSessionId\n        })\n      });\n      \n      if (response.ok) {\n        const outline = await response.json();\n        \n        // Convert outline to story format\n        const storyContent = `# ${outline.title || storyTitle}\\n\\n## Book Outline\\n\\n**Story Type:** ${outline.book_type}\\n**Estimated Length:** ${outline.estimated_length}\\n**Key Themes:** ${outline.themes?.join(', ')}\\n\\n### Chapters:\\n\\n${outline.chapters?.map((chapter, index) => \n          `**Chapter ${index + 1}: ${chapter.title}**\\n${chapter.theme}\\n`\n        ).join('\\n') || 'Chapters will be generated based on your interview content.'}\\n\\n## Your Story\\n\\nBased on our conversation, here's the beginning of your story...\\n\\n${aiMessages.filter(msg => msg.role === 'user').map(msg => msg.content).join('\\n\\n')}`;\n        \n        setGeneratedStory(storyContent);\n        setEditedStory(storyContent);\n        setCurrentStep(5);\n      }\n    } catch (error) {\n      console.error('Error generating AI book outline:', error);\n    }\n    setIsLoading(false);\n  };\n\n  const generateStoryFromTraditional = async () => {\n    setIsLoading(true);\n    setCurrentStep(4);\n    \n    try {\n      const response = await fetch(`${API_BASE_URL}/api/generate-story`, {\n        method: 'POST',\n        headers: { \n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        },\n        body: JSON.stringify({\n          storyType,\n          title: storyTitle,\n          answers,\n          uploadedFiles: uploadedFiles.map(f => ({ name: f.name, type: f.type }))\n        })\n      });\n      \n      if (response.ok) {\n        const data = await response.json();\n        setGeneratedStory(data.story);\n        setEditedStory(data.story);\n      } else {\n        const errorData = await response.json();\n        console.error('Story generation error:', errorData.message);\n        alert(`Story generation failed: ${errorData.message}`);\n        // Fallback to demo story\n        const demoStory = `# ${storyTitle}\\n\\nBased on your responses, here is your personalized story...\\n\\n${Object.values(answers).join('\\n\\n')}`;\n        setGeneratedStory(demoStory);\n        setEditedStory(demoStory);\n      }\n    } catch (error) {\n      console.error('Story generation error:', error);\n      alert('Story generation failed. Please try again.');\n      // Fallback demo story\n      const demoStory = `# ${storyTitle}\\n\\nBased on your responses, here is your personalized story...\\n\\n${Object.values(answers).join('\\n\\n')}`;\n      setGeneratedStory(demoStory);\n      setEditedStory(demoStory);\n    }\n    setIsLoading(false);\n  };\n\n  const saveStory = async () => {\n    setIsLoading(true);\n    try {\n      const response = await fetch(`${API_BASE_URL}/api/story`, {\n        method: 'POST',\n        headers: { \n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        },\n        body: JSON.stringify({\n          title: storyTitle,\n          content: editedStory,\n          summary: `${storyType} story created through AI interview process`,\n          tags: [storyType, 'ai-generated', 'interview']\n        })\n      });\n      \n      if (response.ok) {\n        const data = await response.json();\n        alert('Story saved successfully!');\n        console.log('Saved story:', data.story);\n      } else {\n        const errorData = await response.json();\n        console.error('Save error:', errorData.message);\n        alert(`Save failed: ${errorData.message}`);\n      }\n    } catch (error) {\n      console.error('Save error:', error);\n      alert('Story saved locally! (Network error occurred)');\n    }\n    setIsLoading(false);\n  };\n\n  const renderStepIndicator = () => (\n    <div className=\"flex items-center justify-center mb-8\">\n      {[1, 2, 3, 4, 5].map((step) => (\n        <div key={step} className=\"flex items-center\">\n          <div className={`w-10 h-10 rounded-full flex items-center justify-center text-white font-bold ${\n            currentStep >= step ? 'bg-orange-500' : 'bg-gray-300'\n          }`}>\n            {currentStep > step ? '✓' : step}\n          </div>\n          {step < 5 && (\n            <div className={`w-16 h-1 ${currentStep > step ? 'bg-orange-500' : 'bg-gray-300'}`} />\n          )}\n        </div>\n      ))}\n    </div>\n  );\n\n  const renderStoryTypeSelection = () => (\n    <div className=\"max-w-4xl mx-auto\">\n      <h2 className=\"text-3xl font-bold text-center mb-8\">Choose Your Story Type</h2>\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n        {Object.entries(storyTypes).map(([key, type]) => (\n          <div\n            key={key}\n            onClick={() => {\n              setStoryType(key);\n              setCurrentStep(2);\n            }}\n            className={`story-type-card ${storyType === key ? 'selected' : ''}`}\n          >\n            <div className={`w-12 h-12 rounded-lg ${type.color} mb-4 flex items-center justify-center`}>\n              <span className=\"text-white text-2xl\">📖</span>\n            </div>\n            <h3 className=\"text-xl font-semibold mb-2\">{type.name}</h3>\n            <p className=\"text-gray-600 text-sm\">\n              {key === 'autobiography' && 'Tell your complete life story from childhood to present'}\n              {key === 'memoir' && 'Focus on a specific period or theme in your life'}\n              {key === 'family-history' && 'Preserve your family heritage and traditions'}\n              {key === 'travel' && 'Share your adventures and travel experiences'}\n              {key === 'professional' && 'Document your career journey and achievements'}\n              {key === 'custom' && 'Create a personalized story on any topic'}\n            </p>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n\n  const renderStorySetup = () => (\n    <div className=\"max-w-2xl mx-auto\">\n      <h2 className=\"text-3xl font-bold text-center mb-8\">Story Setup</h2>\n      <div className=\"space-y-6\">\n        <div>\n          <label className=\"block text-lg font-medium mb-2\">Story Title</label>\n          <input\n            type=\"text\"\n            value={storyTitle}\n            onChange={(e) => setStoryTitle(e.target.value)}\n            placeholder=\"Enter a title for your story...\"\n            className=\"w-full p-4 border border-gray-300 rounded-lg text-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent\"\n          />\n        </div>\n        \n        <div>\n          <label className=\"block text-lg font-medium mb-2\">Upload Supporting Materials (Optional)</label>\n          <div\n            onClick={() => fileInputRef.current?.click()}\n            className=\"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-orange-500 transition-colors\"\n          >\n            <span className=\"text-6xl mb-4 block\">📁</span>\n            <p className=\"text-lg text-gray-600\">Click to upload photos, documents, or other files</p>\n            <p className=\"text-sm text-gray-500 mt-2\">Supports images, PDFs, and text documents</p>\n          </div>\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            multiple\n            accept=\"image/*,.pdf,.doc,.docx,.txt\"\n            onChange={handleFileUpload}\n            className=\"hidden\"\n          />\n        </div>\n\n        {uploadedFiles.length > 0 && (\n          <div className=\"space-y-2\">\n            <h3 className=\"font-medium\">Uploaded Files:</h3>\n            {uploadedFiles.map((file) => (\n              <div key={file.id} className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n                <div className=\"flex items-center space-x-3\">\n                  {file.preview ? (\n                    <img src={file.preview} alt={file.name} className=\"w-12 h-12 object-cover rounded\" />\n                  ) : (\n                    <span className=\"text-2xl\">📄</span>\n                  )}\n                  <div>\n                    <p className=\"font-medium\">{file.name}</p>\n                    <p className=\"text-sm text-gray-500\">{(file.size / 1024 / 1024).toFixed(2)} MB</p>\n                  </div>\n                </div>\n                <button\n                  onClick={() => removeFile(file.id)}\n                  className=\"text-red-500 hover:text-red-700\"\n                >\n                  Remove\n                </button>\n              </div>\n            ))}\n          </div>\n        )}\n\n        <div className=\"space-y-4\">\n          <h3 className=\"text-lg font-medium text-center\">Choose Your Interview Experience</h3>\n          \n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <button\n              onClick={startAIInterview}\n              disabled={!storyTitle.trim()}\n              className=\"p-6 bg-gradient-to-r from-purple-500 to-blue-500 text-white rounded-lg font-semibold hover:from-purple-600 hover:to-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-all transform hover:scale-105\"\n            >\n              <div className=\"text-3xl mb-2\">🤖</div>\n              <div className=\"text-lg font-bold mb-2\">AI Ghostwriter Interview</div>\n              <div className=\"text-sm opacity-90\">Professional ghostwriter-style conversation that adapts to your responses and guides you through your story naturally</div>\n            </button>\n            \n            <button\n              onClick={() => {\n                setInterviewMode('traditional');\n                setAiQuestions(storyTypes[storyType]?.questions || []);\n                setCurrentStep(3);\n              }}\n              disabled={!storyTitle.trim()}\n              className=\"p-6 bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-lg font-semibold hover:from-orange-600 hover:to-red-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-all transform hover:scale-105\"\n            >\n              <div className=\"text-3xl mb-2\">📝</div>\n              <div className=\"text-lg font-bold mb-2\">Traditional Q&A</div>\n              <div className=\"text-sm opacity-90\">Structured questions specific to your story type with voice recording and document upload</div>\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n\n  const renderAIInterview = () => {\n    if (interviewMode === 'ai') {\n      return (\n        <div className=\"max-w-4xl mx-auto h-screen flex flex-col\">\n          {/* Header */}\n          <div className=\"bg-white border-b border-gray-200 p-4 flex-shrink-0\">\n            <div className=\"flex justify-between items-center\">\n              <div className=\"flex items-center space-x-3\">\n                <div className=\"w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center\">\n                  <span className=\"text-white text-lg\">🤖</span>\n                </div>\n                <div>\n                  <h3 className=\"font-semibold text-gray-900\">AI Ghostwriter</h3>\n                  <p className=\"text-sm text-gray-500\">\n                    Phase: {aiPhase.replace('_', ' ')} • {aiStoryType ? aiStoryType.replace('_', ' ') : 'Discovering your story'}\n                  </p>\n                </div>\n              </div>\n              \n              <div className=\"flex items-center space-x-2\">\n                {aiThemes.length > 0 && (\n                  <div className=\"flex space-x-1\">\n                    {aiThemes.slice(0, 3).map((theme, index) => (\n                      <span key={index} className=\"px-2 py-1 bg-orange-100 text-orange-700 rounded-full text-xs\">\n                        {theme}\n                      </span>\n                    ))}\n                    {aiThemes.length > 3 && (\n                      <span className=\"px-2 py-1 bg-gray-100 text-gray-600 rounded-full text-xs\">\n                        +{aiThemes.length - 3}\n                      </span>\n                    )}\n                  </div>\n                )}\n                \n                <button\n                  onClick={() => setCurrentStep(4)}\n                  className=\"px-3 py-1 bg-green-500 text-white rounded-lg text-sm hover:bg-green-600\"\n                >\n                  Generate Book\n                </button>\n              </div>\n            </div>\n          </div>\n\n          {/* Chat Messages */}\n          <div className=\"chat-container\">\n            {aiMessages.map((message, index) => (\n              <div key={index} className={`chat-message ${message.role}`}>\n                <div className={`chat-bubble ${message.role}`}>\n                  <div className=\"whitespace-pre-wrap\">\n                    {message.content}\n                  </div>\n                  <div className=\"text-xs mt-1 opacity-70\">\n                    {new Date(message.timestamp).toLocaleTimeString()}\n                  </div>\n                  \n                  {/* Enhancement options for user messages */}\n                  {message.role === 'user' && message.enhanced !== true && (\n                    <div className=\"mt-2 flex space-x-2\">\n                      <button\n                        onClick={() => enhanceMessage(index, message.content)}\n                        className=\"text-xs bg-white bg-opacity-20 hover:bg-opacity-30 px-2 py-1 rounded\"\n                        disabled={isLoading}\n                      >\n                        ✨ Enhance\n                      </button>\n                      <button\n                        onClick={() => editMessage(index)}\n                        className=\"text-xs bg-white bg-opacity-20 hover:bg-opacity-30 px-2 py-1 rounded\"\n                      >\n                        ✏️ Edit\n                      </button>\n                    </div>\n                  )}\n                </div>\n              </div>\n            ))}\n            \n            {isLoading && (\n              <div className=\"flex justify-start\">\n                <div className=\"bg-white text-gray-800 shadow-sm border px-4 py-3 rounded-lg max-w-xs\">\n                  <div className=\"flex items-center space-x-2\">\n                    <div className=\"flex space-x-1\">\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\"></div>\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{animationDelay: '0.1s'}}></div>\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{animationDelay: '0.2s'}}></div>\n                    </div>\n                    <span className=\"text-sm text-gray-500\">AI is thinking...</span>\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* Input Area */}\n          <div className=\"bg-white border-t border-gray-200 p-4 flex-shrink-0\">\n            {transcription && (\n              <div className=\"mb-3 p-3 bg-blue-50 border border-blue-200 rounded-lg\">\n                <div className=\"flex justify-between items-start mb-2\">\n                  <h4 className=\"font-medium text-blue-800 text-sm\">🎤 Voice Transcription:</h4>\n                  <button\n                    onClick={() => setTranscription('')}\n                    className=\"text-blue-600 hover:text-blue-800 text-sm\"\n                  >\n                    ✕\n                  </button>\n                </div>\n                <p className=\"text-blue-700 text-sm mb-3\">{transcription}</p>\n                <div className=\"flex space-x-2\">\n                  <button\n                    onClick={() => enhanceTranscription(transcription)}\n                    className=\"px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600 disabled:bg-gray-300\"\n                    disabled={isLoading}\n                  >\n                    ✨ Enhance & Use\n                  </button>\n                  <button\n                    onClick={() => {\n                      setCurrentAnswer(transcription);\n                      setTranscription('');\n                    }}\n                    className=\"px-3 py-1 bg-gray-500 text-white rounded text-sm hover:bg-gray-600\"\n                  >\n                    Use As Is\n                  </button>\n                </div>\n              </div>\n            )}\n\n            <div className=\"chat-input-container\">\n              <textarea\n                value={currentAnswer}\n                onChange={(e) => setCurrentAnswer(e.target.value)}\n                placeholder=\"Share your thoughts... (or use voice recording)\"\n                className=\"chat-input\"\n                rows=\"3\"\n                onKeyPress={(e) => {\n                  if (e.key === 'Enter' && !e.shiftKey) {\n                    e.preventDefault();\n                    if (currentAnswer.trim()) {\n                      sendAIMessage(currentAnswer);\n                    }\n                  }\n                }}\n              />\n              \n              <div className=\"flex flex-col space-y-2\">\n                <button\n                  onClick={isRecording ? stopRecording : startRecording}\n                  className={`voice-recording-btn ${isRecording ? 'recording' : ''}`}\n                  title={isRecording ? `Recording ${formatTime(recordingTime)}` : 'Start voice recording'}\n                >\n                  <svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                    {isRecording ? (\n                      <rect x=\"6\" y=\"6\" width=\"12\" height=\"12\" rx=\"2\"/>\n                    ) : (\n                      <path d=\"M12 2a3 3 0 0 0-3 3v6a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z\"/>\n                    )}\n                  </svg>\n                  {isRecording ? '🛑' : '🎤'}\n                </button>\n                \n                <button\n                  onClick={() => sendAIMessage(currentAnswer)}\n                  disabled={!currentAnswer.trim() || isLoading}\n                  className=\"chat-send-btn\"\n                  title=\"Send message\"\n                >\n                  ➤\n                </button>\n              </div>\n            </div>\n\n            {/* Quick Actions */}\n            <div className=\"flex justify-between items-center mt-3 text-sm\">\n              <div className=\"flex space-x-3\">\n                <button\n                  onClick={() => sendAIMessage(\"I'd like to skip this question and come back to it later.\")}\n                  className=\"text-gray-600 hover:text-purple-600 transition-colors\"\n                  disabled={isLoading}\n                >\n                  ⏭️ Skip Question\n                </button>\n                <button\n                  onClick={() => sendAIMessage(\"Can we go back to a previous topic?\")}\n                  className=\"text-gray-600 hover:text-purple-600 transition-colors\"\n                  disabled={isLoading}\n                >\n                  ⬅️ Go Back\n                </button>\n                <button\n                  onClick={() => sendAIMessage(\"I need a moment to think about this.\")}\n                  className=\"text-gray-600 hover:text-purple-600 transition-colors\"\n                  disabled={isLoading}\n                >\n                  ⏸️ Pause\n                </button>\n              </div>\n              \n              <div className=\"text-gray-500\">\n                Press Enter to send • Shift+Enter for new line\n              </div>\n            </div>\n\n            {audioBlob && (\n              <div className=\"mt-2 flex items-center space-x-2\">\n                <button\n                  onClick={() => {\n                    const audio = new Audio(URL.createObjectURL(audioBlob));\n                    audio.play();\n                  }}\n                  className=\"flex items-center space-x-1 px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm\"\n                >\n                  <span>▶️</span>\n                  <span>Play Recording</span>\n                </button>\n                <button\n                  onClick={() => setAudioBlob(null)}\n                  className=\"text-gray-500 hover:text-red-500 text-sm\"\n                >\n                  Delete\n                </button>\n              </div>\n            )}\n          </div>\n        </div>\n      );\n    } else {\n      // Traditional Q&A Mode\n      return (\n        <div className=\"max-w-4xl mx-auto\">\n          <div className=\"bg-white rounded-lg shadow-lg p-8\">\n            <div className=\"mb-6\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <h3 className=\"text-xl font-semibold text-gray-900\">Traditional Q&A Interview</h3>\n                <span className=\"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm\">\n                  Question {currentQuestionIndex + 1} of {aiQuestions.length}\n                </span>\n              </div>\n              <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                <div \n                  className=\"bg-blue-500 h-2 rounded-full transition-all duration-300\"\n                  style={{ width: `${((currentQuestionIndex + 1) / aiQuestions.length) * 100}%` }}\n                ></div>\n              </div>\n            </div>\n\n            <div className=\"mb-8\">\n              <h4 className=\"text-lg font-medium text-gray-800 mb-4\">\n                {aiQuestions[currentQuestionIndex]}\n              </h4>\n              \n              <textarea\n                value={currentAnswer}\n                onChange={(e) => setCurrentAnswer(e.target.value)}\n                placeholder=\"Share your thoughts here...\"\n                className=\"w-full p-4 border border-gray-300 rounded-lg h-32 text-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              />\n            </div>\n\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex space-x-4\">\n                <button\n                  onClick={isRecording ? stopRecording : startRecording}\n                  className={`flex items-center space-x-2 px-6 py-3 rounded-lg font-semibold transition-colors ${\n                    isRecording \n                      ? 'bg-red-500 text-white hover:bg-red-600' \n                      : 'bg-blue-500 text-white hover:bg-blue-600'\n                  }`}\n                >\n                  <span>{isRecording ? '🛑' : '🎤'}</span>\n                  <span>{isRecording ? `Recording ${formatTime(recordingTime)}` : 'Voice Recording'}</span>\n                </button>\n\n                {audioBlob && (\n                  <button\n                    onClick={() => {\n                      const audio = new Audio(URL.createObjectURL(audioBlob));\n                      audio.play();\n                    }}\n                    className=\"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50\"\n                  >\n                    <span>▶️</span>\n                    <span>Play Recording</span>\n                  </button>\n                )}\n              </div>\n\n              <div className=\"flex space-x-3\">\n                <button\n                  onClick={previousQuestion}\n                  disabled={currentQuestionIndex === 0}\n                  className=\"px-6 py-3 bg-gray-500 text-white rounded-lg font-semibold hover:bg-gray-600 disabled:bg-gray-300 disabled:cursor-not-allowed\"\n                >\n                  Previous\n                </button>\n                <button\n                  onClick={nextQuestion}\n                  className=\"px-6 py-3 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600\"\n                >\n                  {currentQuestionIndex === aiQuestions.length - 1 ? 'Finish' : 'Next'}\n                </button>\n              </div>\n            </div>\n\n            {transcription && (\n              <div className=\"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg\">\n                <h4 className=\"font-medium text-green-800 mb-2\">🎤 Transcription:</h4>\n                <p className=\"text-green-700 mb-3\">{transcription}</p>\n                <div className=\"flex space-x-2\">\n                  <button\n                    onClick={() => enhanceTranscription(transcription)}\n                    className=\"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:bg-gray-300\"\n                    disabled={isLoading}\n                  >\n                    ✨ Enhance with AI\n                  </button>\n                  <button\n                    onClick={keepTranscriptionAsIs}\n                    className=\"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600\"\n                  >\n                    ✓ Keep As Is\n                  </button>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      );\n    }\n  };\n\n  // Enhanced message functions for chatbot interface\n  const enhanceMessage = async (messageIndex, content) => {\n    setIsLoading(true);\n    try {\n      const response = await fetch(`${API_BASE_URL}/api/enhance-text`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Bearer demo-token'\n        },\n        body: JSON.stringify({\n          text: content,\n          enhancement_type: 'storytelling'\n        })\n      });\n\n      if (response.ok) {\n        const data = await response.json();\n        const updatedMessages = [...aiMessages];\n        updatedMessages[messageIndex] = {\n          ...updatedMessages[messageIndex],\n          content: data.enhanced_text,\n          enhanced: true\n        };\n        setAiMessages(updatedMessages);\n      } else {\n        alert('Enhancement failed. Please try again.');\n      }\n    } catch (error) {\n      console.error('Enhancement error:', error);\n      alert('Enhancement failed. Please try again.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const editMessage = (messageIndex) => {\n    const message = aiMessages[messageIndex];\n    const newContent = prompt('Edit your message:', message.content);\n    if (newContent && newContent !== message.content) {\n      const updatedMessages = [...aiMessages];\n      updatedMessages[messageIndex] = {\n        ...updatedMessages[messageIndex],\n        content: newContent\n      };\n      setAiMessages(updatedMessages);\n    }\n  };\n\n  const renderStoryGeneration = () => (\n    <div className=\"max-w-4xl mx-auto\">\n      <h2 className=\"text-3xl font-bold text-center mb-8\">Your Generated Story</h2>\n      \n      {isLoading ? (\n        <div className=\"text-center py-12\">\n          <div className=\"animate-spin rounded-full h-16 w-16 border-b-2 border-orange-500 mx-auto mb-4\"></div>\n          <p className=\"text-lg text-gray-600\">AI is crafting your story...</p>\n        </div>\n      ) : (\n        <div className=\"space-y-6\">\n          <div className=\"flex justify-between items-center\">\n            <h3 className=\"text-xl font-semibold\">Story Preview</h3>\n            <div className=\"space-x-4\">\n              <button\n                onClick={() => setShowPreview(!showPreview)}\n                className=\"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50\"\n              >\n                <span>👁️</span>\n                <span>{showPreview ? 'Edit Mode' : 'Preview Mode'}</span>\n              </button>\n            </div>\n          </div>\n\n          {showPreview ? (\n            <div className=\"prose max-w-none p-6 bg-white rounded-lg shadow-lg\">\n              <div dangerouslySetInnerHTML={{ __html: editedStory.replace(/\\n/g, '<br>') }} />\n            </div>\n          ) : (\n            <div>\n              <label className=\"block text-lg font-medium mb-2\">Edit Your Story</label>\n              <textarea\n                value={editedStory}\n                onChange={(e) => setEditedStory(e.target.value)}\n                className=\"w-full p-4 border border-gray-300 rounded-lg h-96 text-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent\"\n              />\n            </div>\n          )}\n\n          <div className=\"flex justify-between\">\n            <button\n              onClick={() => setCurrentStep(3)}\n              className=\"flex items-center space-x-2 px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50\"\n            >\n              <span>⬅️</span>\n              <span>Back to Interview</span>\n            </button>\n\n            <div className=\"space-x-4\">\n              <button\n                onClick={() => setCurrentStep(5)}\n                className=\"flex items-center space-x-2 px-6 py-3 bg-orange-500 text-white rounded-lg hover:bg-orange-600\"\n              >\n                <span>Finalize Story</span>\n                <span>➡️</span>\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n\n  const renderStoryFinalization = () => (\n    <div className=\"max-w-4xl mx-auto\">\n      <h2 className=\"text-3xl font-bold text-center mb-8\">Story Complete!</h2>\n      \n      <div className=\"bg-white rounded-lg shadow-lg p-8\">\n        <div className=\"text-center mb-8\">\n          <span className=\"text-6xl mb-4 block\">✅</span>\n          <h3 className=\"text-2xl font-semibold mb-2\">Your story \"{storyTitle}\" is ready!</h3>\n          <p className=\"text-gray-600\">Choose what you'd like to do next with your story.</p>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <button\n            onClick={saveStory}\n            className=\"flex items-center justify-center space-x-3 p-6 border-2 border-orange-500 rounded-lg hover:bg-orange-50 transition-colors\"\n          >\n            <span className=\"text-orange-500 text-2xl\">💾</span>\n            <div className=\"text-left\">\n              <h4 className=\"font-semibold\">Save Story</h4>\n              <p className=\"text-sm text-gray-600\">Save to your dashboard for later editing</p>\n            </div>\n          </button>\n\n          <button\n            onClick={() => alert('Book cover creation feature coming soon!')}\n            className=\"flex items-center justify-center space-x-3 p-6 border-2 border-blue-500 rounded-lg hover:bg-blue-50 transition-colors\"\n          >\n            <span className=\"text-blue-500 text-2xl\">📷</span>\n            <div className=\"text-left\">\n              <h4 className=\"font-semibold\">Create Book Cover</h4>\n              <p className=\"text-sm text-gray-600\">Design a beautiful cover for your story</p>\n            </div>\n          </button>\n\n          <button\n            onClick={() => alert('Publishing feature coming soon!')}\n            className=\"flex items-center justify-center space-x-3 p-6 border-2 border-green-500 rounded-lg hover:bg-green-50 transition-colors\"\n          >\n            <span className=\"text-green-500 text-2xl\">📚</span>\n            <div className=\"text-left\">\n              <h4 className=\"font-semibold\">Publish Book</h4>\n              <p className=\"text-sm text-gray-600\">Publish to Amazon KDP or other platforms</p>\n            </div>\n          </button>\n\n          <button\n            onClick={() => {\n              const element = document.createElement('a');\n              const file = new Blob([editedStory], { type: 'text/plain' });\n              element.href = URL.createObjectURL(file);\n              element.download = `${storyTitle}.txt`;\n              document.body.appendChild(element);\n              element.click();\n              document.body.removeChild(element);\n            }}\n            className=\"flex items-center justify-center space-x-3 p-6 border-2 border-purple-500 rounded-lg hover:bg-purple-50 transition-colors\"\n          >\n            <span className=\"text-purple-500 text-2xl\">⬇️</span>\n            <div className=\"text-left\">\n              <h4 className=\"font-semibold\">Download Story</h4>\n              <p className=\"text-sm text-gray-600\">Download as text file or PDF</p>\n            </div>\n          </button>\n        </div>\n\n        <div className=\"mt-8 text-center\">\n          <button\n            onClick={() => {\n              setCurrentStep(1);\n              setStoryType('');\n              setStoryTitle('');\n              setAnswers({});\n              setUploadedFiles([]);\n              setGeneratedStory('');\n              setEditedStory('');\n              setCurrentQuestionIndex(0);\n            }}\n            className=\"px-8 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors\"\n          >\n            Create Another Story\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-orange-400 via-orange-500 to-orange-600 py-8\">\n      <div className=\"container mx-auto px-4\">\n        {renderStepIndicator()}\n        \n        <div className=\"bg-gray-50 rounded-lg shadow-xl p-8\">\n          {currentStep === 1 && renderStoryTypeSelection()}\n          {currentStep === 2 && renderStorySetup()}\n          {currentStep === 3 && renderAIInterview()}\n          {currentStep === 4 && renderStoryGeneration()}\n          {currentStep === 5 && renderStoryFinalization()}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default StoryCreator;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}